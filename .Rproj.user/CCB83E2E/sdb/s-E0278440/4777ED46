{
    "collab_server" : "",
    "contents" : "\n\n##Same histograms as above, but ONLY only voxels deemed \"active\" in biological task, compared to random task\n```{r}\n#plot histogram of time activity for different tasks, over ONLY active voxels\np1 <- ggplot(data=stack(subset(c1045.as.column, subset = BrainMask != 0 & ClusterMask > 0), \n                        select = c(FALSE,FALSE,FALSE,paradigm$Biological) )) +\n  geom_histogram(aes(x=values))\n\np2 <- ggplot(data=stack(subset(c1045.as.column, subset = BrainMask != 0 & ClusterMask >0 ), \n                        select = c(FALSE,FALSE,FALSE,paradigm$Random) )) +\n  geom_histogram(aes(x=values))\n\np3 <- ggplot(data=stack(subset(c1045.as.column, subset = BrainMask != 0 & ClusterMask > 0), \n                        select = ! (names(c1045.as.column) %in% c(\"BrainMask\", \"ZStat\", \"ClusterMask\")) )) +\n  geom_histogram(aes(x=values))\n\ngrid.arrange(p1,p2,p3,ncol=3)\n```\n\n##Scatterplot of BOLD Activity vs Z Statistic (for biological > random) over time points with biological task ON and OFF, and time points with random task ON and OFF\n```{r}\n#gather all time activitry points into one column, for all masked points.\n#introduce group factors for biological vs motion, and activation region vs. not activated\nresult <- subset(c1045.as.column, subset = BrainMask != 0) %>%\n  gather(key = \"Label\", value = \"Activity\", 4:ncol(c1045.as.column)) %>%\n  mutate(on.off = Label %in% names(c1045.as.column)[c(FALSE, FALSE, FALSE, paradigm$Biological)])\nresult$color.groups <- \"None\"\nresult$color.groups[result$ClusterMask == 0 & result$on.off == TRUE] <- \"1Biological, Not Active\"\nresult$color.groups[result$ClusterMask == 0 & result$on.off == FALSE] <- \"2Random, Not Active\"\nresult$color.groups[result$ClusterMask > 0 & result$on.off == TRUE] <- \"3Biological, Activated\"\nresult$color.groups[result$ClusterMask > 0 & result$on.off == FALSE] <- \"4Random, Activated\"\n\nresult$color.groups <- as.factor(result$color.groups)\n\n#get just a small sample (1%) of the activity data, otherwise too many voxels\nsampleres <- result %>% group_by(on.off) %>% sample_frac(size = .01, replace = FALSE)\n\n\n#scatterplot of Z Statistic (biological > random) vs activity levels,\n#for biological task ON, random taks ON\nggplot() +\n  geom_point(data = sampleres, aes(x=ZStat, y=Activity, color=color.groups)) +\n  labs(y = \"BOLD Signal Level\", x=\"Z Stat\") + \n  geom_line(data = sampleres, aes(x=floor(ZStat*10)/10,y=floor(Activity/5)*5, color = paste(\"Average over activation = \",on.off)), stat=\"summary\",   fun.y = mean) +\n  scale_color_manual(values=c(\"#FFCCFF\", \"#9999CC\", \"#66CC99\", \"#3399CC\", \"Red\", \"Blue\"))\n```\n\n##Same plot as above, but with the BOLD signal at each voxel noramlized (means subtracted from each voxel's time plot)\n```{r}\n###repeat the above, but using CENTERED fMRI data (mean centered at 0)\n\n\nresult <- subset(c1045.as.column.centered, subset = BrainMask != 0) %>%\n  gather(key = \"Label\", value = \"Activity\", 4:ncol(c1045.as.column.centered)) %>%\n  mutate(on.off = Label %in% names(c1045.as.column.centered)[c(FALSE, FALSE, FALSE, paradigm$Biological)])\nresult$color.groups <- \"None\"\nresult$color.groups[result$ClusterMask == 0 & result$on.off == TRUE] <- \"1Biological, Not Active\"\nresult$color.groups[result$ClusterMask == 0 & result$on.off == FALSE] <- \"2Random, Not Active\"\nresult$color.groups[result$ClusterMask > 0 & result$on.off == TRUE] <- \"3Biological, Activated\"\nresult$color.groups[result$ClusterMask > 0 & result$on.off == FALSE] <- \"4Random, Activated\"\n\nresult$color.groups <- as.factor(result$color.groups)\n\n#get just a small sample (1%) of the activity data, otherwise too many voxels\nsampleres <- result %>% group_by(on.off) %>% sample_frac(size = .01, replace = FALSE)\n```\n\n###Looking at relationship between BOLD activity levels, between biological, random\n##Histograms ONLY over active voxels\n```{r}\n#scatterplot of Z Statistic (biological > random) vs activity levels,\n#for biological task ON, random taks ON\nggplot() +\n  geom_point(data = sampleres, aes(x=ZStat, y=Activity, color=color.groups)) +\n  labs(y = \"BOLD Signal Level\", x=\"Z Stat\") + \n  geom_line(data = sampleres, aes(x=floor(ZStat*10)/10,y=floor(Activity/5)*5, color = paste(\"Average over activation = \",on.off)), stat=\"summary\",   fun.y = mean) +\n  scale_color_manual(values=c(\"#FFCCFF\", \"#9999CC\", \"#66CC99\", \"#3399CC\", \"Red\", \"Blue\"))\n\n\n###Looking at relationship between activity levels, between biological, random\n##plot histogram of activity levels for different tasks, over ONLY active voxels\np1 <- ggplot(data=stack(subset(c1045.as.column.centered, subset = BrainMask != 0 & ClusterMask > 0), \n                        select = -c(1,2,3) )) +\n  geom_histogram(aes(x=values), binwidth = 3) +\n  scale_x_continuous(limits = c(-100,100))\n\ntemp <- stack(subset(c1045.as.column.centered, subset = BrainMask != 0 & ClusterMask ==0 ), \n              select = -c(1,2,3) )\ntemp <- sample_frac(temp, size=.1, replace=FALSE)\n\n\np2 <- ggplot(data=temp) +\n  geom_histogram(aes(x=values), binwidth = 3) +\n  scale_x_continuous(limits = c(-100,100))\n\n\ngrid.arrange(p1,p2,ncol=2)\n\ntemp <- gather(subset(c1045.as.column.centered, subset = BrainMask != 0),\n               key = \"TimePoint\", value = \"result\", 4:ncol(c1045.as.column.centered))\ntemp <- sample_frac(temp, size=.1, replace=FALSE)\nggplot(data=temp) +\n  geom_boxplot(aes(x= ClusterMask == 0, y=result)) +\n  ylim(c(-100,100)) +\n  labs(x=\"Active Region\", y=\"BOLD Signal Intensity\")\n\n\n\n##histogram of Z scores\n#ggplot(data=sample) +\n#  geom_histogram(aes(x=.5*log((1+ZStat)/(1-ZStat)))) +\n#  labs(x=\"Fisher transform of Z Stat\") +\n#  facet_wrap(~on.off) \n\n##boxplot of Z scores for on and off\n#ggplot(data=sample) +\n#  geom_boxplot(aes(x=on.off, y=ZStat))\n\n\n```\n\n##Compute correlation coefficients between biological even paradigm, and time activity\n##signal for all voxels\n\n```{r}\nc1045.as.column$corr.biological <- apply(subset(c1045.as.column, \n                                                select = ! names(c1045.as.column) %in% c(\"BrainMask\", \"ZStat\", \"ClusterMask\", \"corr.biological\")),\n                                         1, cor, paradigm$Biological)\n\ntemp <- sample_frac(subset(c1045.as.column, BrainMask != 0), size = .1, replace = FALSE)\n\nggplot(data = temp, aes(x=ZStat, y=corr.biological)) +\n  geom_point(aes(color=ClusterMask)) +\n  labs(y=\"Correlation Coefficient\")\n\n```\n\n",
    "created" : 1459962898540.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2785113958",
    "id" : "4777ED46",
    "lastKnownWriteTime" : 1460354592,
    "last_content_update" : 1460354592941,
    "path" : "~/Documents/Foundations_Course/Capstone/exploratory_script_EDA.R",
    "project_path" : "exploratory_script_EDA.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}